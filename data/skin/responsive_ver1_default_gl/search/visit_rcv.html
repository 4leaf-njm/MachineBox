<div class="container-fluid top-pt calc-wrap">
    <!-- {? page == '01'} -->
    <div class="container pt-5">
        <form action="/sch/visit_rcv_process" method="post" id="frm_visit_rcv">
            <input type="hidden" name="page" value="{page}"/>
            <input type="hidden" name="visit_seq" value="{visit_seq}" />
            <input type="hidden" name="estimate_seq" value="{estimate_seq}" />
            <div class="row pb-4 mb-5" style="border: 1px solid #eeeeee; border-radius: 10px;">
                <!-- {? estimate_seq} -->
                <div class="col-12 mt-4">
                    <h1 class="wrap-title txt-center txt-medium mb-3" style="font-size: 1.2rem;">현장 미팅 신청</h1>
                    <h1 class="wrap-title txt-center txt-medium mt-2 mb-3" style="font-size: 1.2rem; color: #d78323">안녕하세요. {sale_userid} 판매자님!</h1>
                    <p class="wrap-title-sub txt-light">딜러사로부터 등록하신 {model_name} ({sales_no})의 매입<br/>현장방문 신청이 들어왔습니다. 미팅 진행을 하시겠습니까 ?</p>
                </div>
                <!-- {:} -->
                <div class="col-12 mt-4">
                    <h1 class="wrap-title txt-center txt-medium mb-3" style="font-size: 1.2rem;">현장 미팅 신청</h1>
                    <h1 class="wrap-title txt-center txt-medium mt-2 mb-3" style="font-size: 1.2rem; color: #d78323">안녕하세요. {sale_userid} 판매자님!</h1>
                    <p class="wrap-title-sub txt-light">구매 예정자로부터 등록하신 {model_name} ({sales_no})의 매입<br/>현장방문 신청이 들어왔습니다. 미팅 진행을 하시겠습니까 ?</p>
                </div>
                <!-- {/} -->
                <div class="col-12 txt-center mt-3 pl-4 pr-4">
                    <hr style="display: block; border: none; border-bottom: 1px solid #dcdcdc;" />
                </div>
                
                <div class="col-12 txt-center mt-3">
                    <!-- {? estimate_seq} -->
                    <p class="wrap-title-sub txt-light">기계 판매 현장미팅 전에 <b><u>긴급판매 이용수수료의 결제</u></b>를 하셔야 합니다.<br/><b>이용수수료는 기계 판매 금액의 2.2%(부가세포함)</b>입니다.<br/>단, 이용수수료는 최초 1회만(60일이내) 청구되며, 결제가 완료된 해당 기계는>별도의 추가 비용이 발생되지 않습니다.<br />론칭 이벤트 이용수수료 할인&nbsp;&nbsp;&nbsp;<b><big><strike>2.2%</strike> → 1.1%</big></b></p>
                    <!-- {:} -->
                    <p class="wrap-title-sub txt-light">기계 판매 현장미팅 전에 <b><u>셀프판매 이용수수료의 결제</u></b>를 하셔야 합니다.<br/><b>이용수수료는 기계 판매 금액의 2.2%(부가세포함)</b>입니다.<br/>단, 이용수수료는 최초 1회만(60일이내) 청구되며, 결제가 완료된 해당 기계는>별도의 추가 비용이 발생되지 않습니다.<br />론칭 이벤트 이용수수료 할인&nbsp;&nbsp;&nbsp;<b><big><strike>2.2%</strike> → 1.1%</big></b></p>
                    <!-- {/} -->
                </div>
                
                <div class="col-12 txt-center mt-4">
                    <button type="button" class="btn-type-02 download-btn txt-medium" onclick="go_visit_rcv_process('{page}')">결제하기</button>
                </div>
            </div>
        </form>
    </div>
    <!-- {: page == '02'} -->
    <div class="container pt-5">
        <form action="/sch/visit_rcv_process" method="post" id="frm_visit_rcv">
            <input type="hidden" name="page" value="{page}"/>
            <input type="hidden" name="visit_seq" value="{visit_seq}" />
            <input type="hidden" name="vdet_seq" />
            <input type="hidden" name="estimate_seq" value="{estimate_seq}" />
            <div class="row pb-4 mb-5" style="border: 1px solid #eeeeee; border-radius: 10px;">
                <!-- {? estimate_seq} -->
                <div class="col-12 mb-4 mt-4">
                    <h1 class="wrap-title txt-center txt-medium mb-2" style="font-size: 1.2rem;">판매자님께서 신청하신 미팅예정일입니다.</h1>
                    <p class="wrap-title-sub">아래의 일정 중 딜러사님의 미팅 가능한 1가지 일정을 선택해주세요.</p>
                </div>
                <!-- {:} -->
                <div class="col-12 mb-4 mt-4">
                    <h1 class="wrap-title txt-center txt-medium mb-2" style="font-size: 1.2rem;">구매예정자님께서 신청하신 미팅예정일입니다.</h1>
                    <p class="wrap-title-sub">아래의 일정 중 판매자님의 미팅 가능한 1가지 일정을 선택해주세요.</p>
                </div>
                <!-- {/} -->
                <div class="col-12 pb-3">
                    <!-- {@ det_list} -->
                    <div class="checkbox-div mt-2 mb-2">
                        <input type="radio" name="visit_date" id="date_0{.index_+1}" class="checkbox_style_01" value="{.vdet_seq}">
                        <label for="date_0{.index_+1}">{.full_date}</label>
                    </div>
                    <!-- {/} -->
                </div>
                <div class="col-12 pb-3 txt-center">
                    <input type="hidden" name="location" />
                    <input type="text" class="input-style input-border-none input-md input-gray d-none d-md-inline-block txt-center txt_location" placeholder="기계 소재지 주소를 입력해주세요."/>
                    <input type="text" class="input-style input-border-none input-lg input-gray d-inline-block d-md-none txt-center txt_location" placeholder="기계 소재지 주소를 입력해주세요."/>
                </div>
                <div class="col-12 txt-center mt-4">
                    <button type="button" class="btn-type-02 download-btn txt-medium" onclick="go_visit_rcv_process('{page}')">예약하기</button>
                </div>
            </div>
        </form>
    </div>
    <!-- {/} -->
</div>

<script>
function go_visit_rcv_process(page) {
    if(page == '01') {
        if(confirm('결제를 진행하시겠습니까 ?')) {
            $('#frm_visit_rcv').submit();
        }
    } else if (page == '02') {
        var vdet_seq = $('input[name=visit_date]:checked').val();
        if(!vdet_seq) {
            alert('미팅일을 선택해주세요.'); 
            return;
        }
        var res = false;
        $.each($('.txt_location'), function(index, value) {
            if($(this).val() != '') {
                $('input[name=location]').val($(this).val());
                res = true;
    
                return;
            }
        });
        if(res == false) {
            alert('기계 소재지를 입력해주세요.');
            return;
        }
        if(confirm('위의 날짜로 미팅일을 선택하시겠습니까 ?')) {
            $('input[name=vdet_seq]').val(vdet_seq);
            $('#frm_visit_rcv').submit();
        }
    }
}
</script> 